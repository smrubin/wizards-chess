!function(r){var e={};function t(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return r[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}t.m=r,t.c=e,t.d=function(r,e,n){t.o(r,e)||Object.defineProperty(r,e,{enumerable:!0,get:n})},t.r=function(r){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},t.t=function(r,e){if(1&e&&(r=t(r)),8&e)return r;if(4&e&&"object"==typeof r&&r&&r.__esModule)return r;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:r}),2&e&&"string"!=typeof r)for(var o in r)t.d(n,o,function(e){return r[e]}.bind(null,o));return n},t.n=function(r){var e=r&&r.__esModule?function(){return r.default}:function(){return r};return t.d(e,"a",e),e},t.o=function(r,e){return Object.prototype.hasOwnProperty.call(r,e)},t.p="",t(t.s=5)}([function(r,e,t){"use strict";var n=t(3);e.a=class{constructor(){this._game=new n}get game(){return this._game}makeRandomMove(r){const e=this.game.moves();if(0===e.length)return;const t=e[Math.floor(Math.random()*e.length)];this.game.move(t),r.position(this.game.fen())}}},function(r,e,t){"use strict";e.a=class{constructor(r="start"){this._board=ChessBoard("wizard-board",{position:r,draggable:!0,onDragStart:this.onDragStart})}get board(){return this._board}onDragStart(){return this.displayError("This is Wizard's Chess"),!1}displayError(r){$(".game-error").html(r)}clearError(){$(".game-error").html("&nbsp;")}}},function(r,e,t){"use strict";var n=t(0),o=t(1);e.a=class{constructor(){this._game=new n.a,this._board=new o.a,this.columns=["a","b","c","d","e","f","g","h"],this.rows=["1","2","3","4","5","6","7","8"],this.pieces=["king","queen","bishop","knight","rook","castle","pawn"],this.squares=this.buildSquares(this.columns,this.rows),this.moves=this.buildMoves(this.squares,this.pieces);const r=this.squares.concat(this.pieces).join(" | "),e=window.SpeechRecognition||window.webkitSpeechRecognition,t=window.SpeechGrammarList||window.webkitSpeechGrammarList,i="#JSGF V1.0; grammar phrase; public <phrase> = "+r+" ;";this.recognition=new e;const a=new t;a.addFromString(i,1),this.recognition.grammars=a,this.recognition.lang="en-US",this.recognition.interimResults=!1,this.recognition.maxAlternatives=1,this.recognition.onnomatch=this.onnomatch.bind(this),this.recognition.onerror=this.onerror.bind(this),this.recognition.onspeechstart=this.onspeechstart.bind(this),this.recognition.onresult=this.onresult.bind(this)}get game(){return this._game}get board(){return this._board}buildSquares(r,e){return r.flatMap(r=>e.map(e=>r.concat(e)))}buildMoves(r,e){return r.flatMap(r=>e.map(e=>e.concat(` to ${r}`)))}start(){console.log("Starting Wizards Chess"),this.recognition.start()}onend(){console.log("Restarting listener."),this.start()}onnomatch(){this.board.displayError("Not a valid Wizards Chess command")}onerror(r){this.board.displayError("An error occurred."),console.error("Error occurred: "+r.error)}onspeechstart(){this.board.clearError(),console.log("Capturing voice input.")}onresult(r){const e=r.results[0][0].transcript.replace(/-/g,"").toLowerCase();if(console.log("Speech: "+e),console.log("Confidence: "+r.results[0][0].confidence),this.game.game.game_over())return this.board.displayError("The game is over.");if("w"!==this.game.game.turn())return this.board.displayError("It is not your turn. Wait for black to move.");const t=this.moves.find(r=>r===e);if(!t)return this.board.displayError("Not a valid move.");console.log("Valid move. Trying move: "+t),this.handleMove(t)}handleMove(r){if(console.log(this.game.game.moves()),console.log("Your move: "+r.slice(-2)),null===this.game.game.move(r.slice(-2)))return this.board.displayError("Not a valid move.");this.board.board.position(this.game.game.fen()),window.setTimeout(()=>{this.game.makeRandomMove(this.board.board)},2e3)}}},function(r,e,t){var n,o=function(r){var e="b",t="w",n=-1,o="p",i="n",a="b",s="r",l="q",u="k",c="pnbrqkPNBRQK",f="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",p=["1-0","0-1","1/2-1/2","*"],h={b:[16,32,17,15],w:[-16,-32,-17,-15]},g={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},d=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],v=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],m={p:0,n:1,b:2,r:3,q:4,k:5},b={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},E={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},_=7,w=6,S=1,y=0,A={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},C={w:[{square:A.a1,flag:E.QSIDE_CASTLE},{square:A.h1,flag:E.KSIDE_CASTLE}],b:[{square:A.a8,flag:E.QSIDE_CASTLE},{square:A.h8,flag:E.KSIDE_CASTLE}]},P=new Array(128),T={w:n,b:n},I=t,R={w:0,b:0},L=n,N=0,O=1,k=[],q={};function D(){P=new Array(128),T={w:n,b:n},I=t,R={w:0,b:0},L=n,N=0,O=1,k=[],q={},j(x())}function K(){Q(f)}function Q(r){var o=r.split(/\s+/),i=o[0],a=0;if(!U(r).valid)return!1;D();for(var s=0;s<i.length;s++){var l=i.charAt(s);if("/"===l)a+=8;else if(-1!=="0123456789".indexOf(l))a+=parseInt(l,10);else{var u=l<"a"?t:e;B({type:l.toLowerCase(),color:u},ar(a)),a++}}return I=o[1],o[2].indexOf("K")>-1&&(R.w|=E.KSIDE_CASTLE),o[2].indexOf("Q")>-1&&(R.w|=E.QSIDE_CASTLE),o[2].indexOf("k")>-1&&(R.b|=E.KSIDE_CASTLE),o[2].indexOf("q")>-1&&(R.b|=E.QSIDE_CASTLE),L="-"===o[3]?n:A[o[3]],N=parseInt(o[4],10),O=parseInt(o[5],10),j(x()),!0}function U(r){var e="No errors.",t="FEN string must contain six space-delimited fields.",n="6th field (move number) must be a positive integer.",o="5th field (half move counter) must be a non-negative integer.",i="4th field (en-passant square) is invalid.",a="3rd field (castling availability) is invalid.",s="2nd field (side to move) is invalid.",l="1st field (piece positions) does not contain 8 '/'-delimited rows.",u="1st field (piece positions) is invalid [consecutive numbers].",c="1st field (piece positions) is invalid [invalid piece].",f="1st field (piece positions) is invalid [row too large].",p="Illegal en-passant square",h=r.split(/\s+/);if(6!==h.length)return{valid:!1,error_number:1,error:t};if(isNaN(h[5])||parseInt(h[5],10)<=0)return{valid:!1,error_number:2,error:n};if(isNaN(h[4])||parseInt(h[4],10)<0)return{valid:!1,error_number:3,error:o};if(!/^(-|[abcdefgh][36])$/.test(h[3]))return{valid:!1,error_number:4,error:i};if(!/^(KQ?k?q?|Qk?q?|kq?|q|-)$/.test(h[2]))return{valid:!1,error_number:5,error:a};if(!/^(w|b)$/.test(h[1]))return{valid:!1,error_number:6,error:s};var g=h[0].split("/");if(8!==g.length)return{valid:!1,error_number:7,error:l};for(var d=0;d<g.length;d++){for(var v=0,m=!1,b=0;b<g[d].length;b++)if(isNaN(g[d][b])){if(!/^[prnbqkPRNBQK]$/.test(g[d][b]))return{valid:!1,error_number:9,error:c};v+=1,m=!1}else{if(m)return{valid:!1,error_number:8,error:u};v+=parseInt(g[d][b],10),m=!0}if(8!==v)return{valid:!1,error_number:10,error:f}}return"3"==h[3][1]&&"w"==h[1]||"6"==h[3][1]&&"b"==h[1]?{valid:!1,error_number:11,error:p}:{valid:!0,error_number:0,error:e}}function x(){for(var r=0,o="",i=A.a8;i<=A.h1;i++){if(null==P[i])r++;else{r>0&&(o+=r,r=0);var a=P[i].color,s=P[i].type;o+=a===t?s.toUpperCase():s.toLowerCase()}i+1&136&&(r>0&&(o+=r),i!==A.h1&&(o+="/"),r=0,i+=8)}var l="";R[t]&E.KSIDE_CASTLE&&(l+="K"),R[t]&E.QSIDE_CASTLE&&(l+="Q"),R[e]&E.KSIDE_CASTLE&&(l+="k"),R[e]&E.QSIDE_CASTLE&&(l+="q"),l=l||"-";var u=L===n?"-":ar(L);return[o,I,l,u,N,O].join(" ")}function M(r){for(var e=0;e<r.length;e+=2)"string"==typeof r[e]&&"string"==typeof r[e+1]&&(q[r[e]]=r[e+1]);return q}function j(r){k.length>0||(r!==f?(q.SetUp="1",q.FEN=r):(delete q.SetUp,delete q.FEN))}function $(r){var e=P[A[r]];return e?{type:e.type,color:e.color}:null}function B(r,e){if(!("type"in r&&"color"in r))return!1;if(-1===c.indexOf(r.type.toLowerCase()))return!1;if(!(e in A))return!1;var t=A[e];return(r.type!=u||T[r.color]==n||T[r.color]==t)&&(P[t]={type:r.type,color:r.color},r.type===u&&(T[r.color]=t),j(x()),!0)}function G(r,e,t,n,i){var a={color:I,from:e,to:t,flags:n,piece:r[e].type};return i&&(a.flags|=E.PROMOTION,a.promotion=i),r[t]?a.captured=r[t].type:n&E.EP_CAPTURE&&(a.captured=o),a}function F(r){function e(r,e,t,n,u){if(r[t].type!==o||or(n)!==y&&or(n)!==_)e.push(G(r,t,n,u));else for(var c=[l,s,a,i],f=0,p=c.length;f<p;f++)e.push(G(r,t,n,u,c[f]))}var t=[],n=I,u=sr(n),c={b:S,w:w},f=A.a8,p=A.h1,d=!1,v=!(void 0!==r&&"legal"in r)||r.legal;if(void 0!==r&&"square"in r){if(!(r.square in A))return[];f=p=A[r.square],d=!0}for(var m=f;m<=p;m++)if(136&m)m+=7;else{var b=P[m];if(null!=b&&b.color===n)if(b.type===o){var C=m+h[n][0];if(null==P[C]){e(P,t,m,C,E.NORMAL);C=m+h[n][1];c[n]===or(m)&&null==P[C]&&e(P,t,m,C,E.BIG_PAWN)}for(N=2;N<4;N++){136&(C=m+h[n][N])||(null!=P[C]&&P[C].color===u?e(P,t,m,C,E.CAPTURE):C===L&&e(P,t,m,L,E.EP_CAPTURE))}}else for(var N=0,O=g[b.type].length;N<O;N++){var k=g[b.type][N];for(C=m;!(136&(C+=k));){if(null!=P[C]){if(P[C].color===n)break;e(P,t,m,C,E.CAPTURE);break}if(e(P,t,m,C,E.NORMAL),"n"===b.type||"k"===b.type)break}}}if(!d||p===T[n]){if(R[n]&E.KSIDE_CASTLE){var q=(D=T[n])+2;null!=P[D+1]||null!=P[q]||H(u,T[n])||H(u,D+1)||H(u,q)||e(P,t,T[n],q,E.KSIDE_CASTLE)}if(R[n]&E.QSIDE_CASTLE){var D;q=(D=T[n])-2;null!=P[D-1]||null!=P[D-2]||null!=P[D-3]||H(u,T[n])||H(u,D-1)||H(u,q)||e(P,t,T[n],q,E.QSIDE_CASTLE)}}if(!v)return t;var K=[];for(m=0,O=t.length;m<O;m++)er(t[m]),V(n)||K.push(t[m]),tr();return K}function W(r,e){var t="";if(r.flags&E.KSIDE_CASTLE)t="O-O";else if(r.flags&E.QSIDE_CASTLE)t="O-O-O";else{var n=function(r,e){for(var t=F({legal:!e}),n=r.from,o=r.to,i=r.piece,a=0,s=0,l=0,u=0,c=t.length;u<c;u++){var f=t[u].from,p=t[u].to,h=t[u].piece;i===h&&n!==f&&o===p&&(a++,or(n)===or(f)&&s++,ir(n)===ir(f)&&l++)}if(a>0)return s>0&&l>0?ar(n):l>0?ar(n).charAt(1):ar(n).charAt(0);return""}(r,e);r.piece!==o&&(t+=r.piece.toUpperCase()+n),r.flags&(E.CAPTURE|E.EP_CAPTURE)&&(r.piece===o&&(t+=ar(r.from)[0]),t+="x"),t+=ar(r.to),r.flags&E.PROMOTION&&(t+="="+r.promotion.toUpperCase())}return er(r),Z()&&(J()?t+="#":t+="+"),tr(),t}function z(r){return r.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}function H(r,n){for(var i=A.a8;i<=A.h1;i++)if(136&i)i+=7;else if(null!=P[i]&&P[i].color===r){var a=P[i],s=i-n,l=s+119;if(d[l]&1<<m[a.type]){if(a.type===o){if(s>0){if(a.color===t)return!0}else if(a.color===e)return!0;continue}if("n"===a.type||"k"===a.type)return!0;for(var u=v[l],c=i+u,f=!1;c!==n;){if(null!=P[c]){f=!0;break}c+=u}if(!f)return!0}}return!1}function V(r){return H(sr(r),T[r])}function Z(){return V(I)}function J(){return Z()&&0===F().length}function Y(){return!Z()&&0===F().length}function X(){for(var r={},e=[],t=0,n=0,o=A.a8;o<=A.h1;o++)if(n=(n+1)%2,136&o)o+=7;else{var s=P[o];s&&(r[s.type]=s.type in r?r[s.type]+1:1,s.type===a&&e.push(n),t++)}if(2===t)return!0;if(3===t&&(1===r[a]||1===r[i]))return!0;if(t===r[a]+2){var l=0,u=e.length;for(o=0;o<u;o++)l+=e[o];if(0===l||l===u)return!0}return!1}function rr(){for(var r=[],e={},t=!1;;){var n=tr();if(!n)break;r.push(n)}for(;;){var o=x().split(" ").slice(0,4).join(" ");if(e[o]=o in e?e[o]+1:1,e[o]>=3&&(t=!0),!r.length)break;er(r.pop())}return t}function er(r){var t=I,i=sr(t);if(function(r){k.push({move:r,kings:{b:T.b,w:T.w},turn:I,castling:{b:R.b,w:R.w},ep_square:L,half_moves:N,move_number:O})}(r),P[r.to]=P[r.from],P[r.from]=null,r.flags&E.EP_CAPTURE&&(I===e?P[r.to-16]=null:P[r.to+16]=null),r.flags&E.PROMOTION&&(P[r.to]={type:r.promotion,color:t}),P[r.to].type===u){if(T[P[r.to].color]=r.to,r.flags&E.KSIDE_CASTLE){var a=r.to-1,s=r.to+1;P[a]=P[s],P[s]=null}else if(r.flags&E.QSIDE_CASTLE){a=r.to+1,s=r.to-2;P[a]=P[s],P[s]=null}R[t]=""}if(R[t])for(var l=0,c=C[t].length;l<c;l++)if(r.from===C[t][l].square&&R[t]&C[t][l].flag){R[t]^=C[t][l].flag;break}if(R[i])for(l=0,c=C[i].length;l<c;l++)if(r.to===C[i][l].square&&R[i]&C[i][l].flag){R[i]^=C[i][l].flag;break}L=r.flags&E.BIG_PAWN?"b"===I?r.to-16:r.to+16:n,r.piece===o?N=0:r.flags&(E.CAPTURE|E.EP_CAPTURE)?N=0:N++,I===e&&O++,I=sr(I)}function tr(){var r=k.pop();if(null==r)return null;var t=r.move;T=r.kings,I=r.turn,R=r.castling,L=r.ep_square,N=r.half_moves,O=r.move_number;var n,i,a=I,s=sr(I);if(P[t.from]=P[t.to],P[t.from].type=t.piece,P[t.to]=null,t.flags&E.CAPTURE)P[t.to]={type:t.captured,color:s};else if(t.flags&E.EP_CAPTURE){var l;l=a===e?t.to-16:t.to+16,P[l]={type:o,color:s}}t.flags&(E.KSIDE_CASTLE|E.QSIDE_CASTLE)&&(t.flags&E.KSIDE_CASTLE?(n=t.to+1,i=t.to-1):t.flags&E.QSIDE_CASTLE&&(n=t.to-2,i=t.to+1),P[n]=P[i],P[i]=null);return t}function nr(r,e){var t=z(r);if(e){var n=t.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/);if(n)var o=n[1],i=n[2],a=n[3],s=n[4]}for(var l=F(),u=0,c=l.length;u<c;u++){if(t===z(W(l[u]))||e&&t===z(W(l[u],!0)))return l[u];if(n&&(!o||o.toLowerCase()==l[u].piece)&&A[i]==l[u].from&&A[a]==l[u].to&&(!s||s.toLowerCase()==l[u].promotion))return l[u]}return null}function or(r){return r>>4}function ir(r){return 15&r}function ar(r){var e=ir(r),t=or(r);return"abcdefgh".substring(e,e+1)+"87654321".substring(t,t+1)}function sr(r){return r===t?e:t}function lr(r){var e=function r(e){var t=e instanceof Array?[]:{};for(var n in e)t[n]="object"==typeof n?r(e[n]):e[n];return t}(r);e.san=W(e,!1),e.to=ar(e.to),e.from=ar(e.from);var t="";for(var n in E)E[n]&e.flags&&(t+=b[n]);return e.flags=t,e}function ur(r){return r.replace(/^\s+|\s+$/g,"")}return Q(void 0===r?f:r),{WHITE:t,BLACK:e,PAWN:o,KNIGHT:i,BISHOP:a,ROOK:s,QUEEN:l,KING:u,SQUARES:function(){for(var r=[],e=A.a8;e<=A.h1;e++)136&e?e+=7:r.push(ar(e));return r}(),FLAGS:b,load:function(r){return Q(r)},reset:function(){return K()},moves:function(r){for(var e=F(r),t=[],n=0,o=e.length;n<o;n++)void 0!==r&&"verbose"in r&&r.verbose?t.push(lr(e[n])):t.push(W(e[n],!1));return t},in_check:function(){return Z()},in_checkmate:function(){return J()},in_stalemate:function(){return Y()},in_draw:function(){return N>=100||Y()||X()||rr()},insufficient_material:function(){return X()},in_threefold_repetition:function(){return rr()},game_over:function(){return N>=100||J()||Y()||X()||rr()},validate_fen:function(r){return U(r)},fen:function(){return x()},pgn:function(r){var e="object"==typeof r&&"string"==typeof r.newline_char?r.newline_char:"\n",t="object"==typeof r&&"number"==typeof r.max_width?r.max_width:0,n=[],o=!1;for(var i in q)n.push("["+i+' "'+q[i]+'"]'+e),o=!0;o&&k.length&&n.push(e);for(var a=[];k.length>0;)a.push(tr());for(var s=[],l="";a.length>0;){var u=a.pop();k.length||"b"!==u.color?"w"===u.color&&(l.length&&s.push(l),l=O+"."):l=O+". ...",l=l+" "+W(u,!1),er(u)}if(l.length&&s.push(l),void 0!==q.Result&&s.push(q.Result),0===t)return n.join("")+s.join(" ");var c=0;for(i=0;i<s.length;i++)c+s[i].length>t&&0!==i?(" "===n[n.length-1]&&n.pop(),n.push(e),c=0):0!==i&&(n.push(" "),c++),n.push(s[i]),c+=s[i].length;return n.join("")},load_pgn:function(r,e){var t=void 0!==e&&"sloppy"in e&&e.sloppy;function n(r){return r.replace(/\\/g,"\\")}var o="object"==typeof e&&"string"==typeof e.newline_char?e.newline_char:"\r?\n",i=new RegExp("^(\\[(.|"+n(o)+")*\\])("+n(o)+")*1.("+n(o)+"|.)*$","g"),a=r.replace(i,"$1");"["!==a[0]&&(a=""),K();var s=function(r,e){for(var t="object"==typeof e&&"string"==typeof e.newline_char?e.newline_char:"\r?\n",o={},i=r.split(new RegExp(n(t))),a="",s="",l=0;l<i.length;l++)a=i[l].replace(/^\[([A-Z][A-Za-z]*)\s.*\]$/,"$1"),s=i[l].replace(/^\[[A-Za-z]+\s"(.*)"\]$/,"$1"),ur(a).length>0&&(o[a]=s);return o}(a,e);for(var l in s)M([l,s[l]]);if("1"===s.SetUp&&!("FEN"in s&&Q(s.FEN)))return!1;var u=r.replace(a,"").replace(new RegExp(n(o),"g")," ");u=u.replace(/(\{[^}]+\})+?/g,"");for(var c=/(\([^\(\)]+\))+?/g;c.test(u);)u=u.replace(c,"");var f=ur(u=(u=(u=u.replace(/\d+\.(\.\.)?/g,"")).replace(/\.\.\./g,"")).replace(/\$\d+/g,"")).split(new RegExp(/\s+/));f=f.join(",").replace(/,,+/g,",").split(",");for(var h="",g=0;g<f.length-1;g++){if(null==(h=nr(f[g],t)))return!1;er(h)}if(h=f[f.length-1],p.indexOf(h)>-1)(function(r){for(var e in r)return!0;return!1})(q)&&void 0===q.Result&&M(["Result",h]);else{if(null==(h=nr(h,t)))return!1;er(h)}return!0},header:function(){return M(arguments)},ascii:function(){return function(){for(var r="   +------------------------+\n",e=A.a8;e<=A.h1;e++){if(0===ir(e)&&(r+=" "+"87654321"[or(e)]+" |"),null==P[e])r+=" . ";else{var n=P[e].type;r+=" "+(P[e].color===t?n.toUpperCase():n.toLowerCase())+" "}e+1&136&&(r+="|\n",e+=8)}return r+="   +------------------------+\n",r+="     a  b  c  d  e  f  g  h\n"}()},turn:function(){return I},move:function(r,e){var t=void 0!==e&&"sloppy"in e&&e.sloppy,n=null;if("string"==typeof r)n=nr(r,t);else if("object"==typeof r)for(var o=F(),i=0,a=o.length;i<a;i++)if(!(r.from!==ar(o[i].from)||r.to!==ar(o[i].to)||"promotion"in o[i]&&r.promotion!==o[i].promotion)){n=o[i];break}if(!n)return null;var s=lr(n);return er(n),s},undo:function(){var r=tr();return r?lr(r):null},clear:function(){return D()},put:function(r,e){return B(r,e)},get:function(r){return $(r)},remove:function(r){return function(r){var e=$(r);return P[A[r]]=null,e&&e.type===u&&(T[e.color]=n),j(x()),e}(r)},perft:function(r){return function r(e){for(var t=F({legal:!1}),n=0,o=I,i=0,a=t.length;i<a;i++)er(t[i]),V(o)||(e-1>0?n+=r(e-1):n++),tr();return n}(r)},square_color:function(r){if(r in A){var e=A[r];return(or(e)+ir(e))%2==0?"light":"dark"}return null},history:function(r){for(var e=[],t=[],n=(void 0!==r&&"verbose"in r&&r.verbose);k.length>0;)e.push(tr());for(;e.length>0;){var o=e.pop();n?t.push(lr(o)):t.push(W(o)),er(o)}return t}}};
/* @license
 * Copyright (c) 2016, Jeff Hlywa (jhlywa@gmail.com)
 * Released under the BSD license
 * https://github.com/jhlywa/chess.js/blob/master/LICENSE
 */e.Chess=o,void 0===(n=function(){return o}.call(e,t,e,r))||(r.exports=n)},,function(r,e,t){"use strict";t.r(e);var n=t(2),o=t(0),i=t(1);(new class extends n.a{constructor(){super(),this._game=new o.a,this._board=new i.a(this.getStartPosition());const r=window.SpeechRecognition||window.webkitSpeechRecognition,e=window.SpeechGrammarList||window.webkitSpeechGrammarList;this.phrase="Knight to H3";const t="#JSGF V1.0; grammar phrase; public <phrase> = "+this.phrase+" ;";this.recognition=new r;const n=new e;n.addFromString(t,1),this.recognition.grammars=n,this.recognition.lang="en-US",this.recognition.interimResults=!1,this.recognition.maxAlternatives=1,this.recognition.onnomatch=this.onnomatch.bind(this),this.recognition.onerror=this.onerror.bind(this),this.recognition.onspeechstart=this.onspeechstart.bind(this),this.recognition.onresult=this.onresult.bind(this)}getStartPosition(){return{f8:"bR",h8:"bK",b7:"bP",c7:"wN",e7:"wR",g7:"bP",h7:"bP",b6:"wP",c6:"bB",a5:"bN",e5:"wP",g5:"bN",h4:"wN",a3:"bB",c3:"wQ",h2:"wP",b1:"wR",g1:"wK"}}onresult(r){const e=r.results[0][0].transcript;return console.log(e),console.log("Confidence"+r.results[0][0].confidence),e.toLowerCase()===this.phrase.toLowerCase()?this.handleMove():this.board.displayError("Not the magical move.")}handleMove(r){this.recognition.onend=function(){},this.recognition.abort(),$(".square-g5 > img").animate({top:"200%"},2e3).animate({left:"100%"},2e3,function(){$(".game").fadeOut(800),$(".success").fadeIn(800).delay(500);const r=document.getElementById("success-video");r.addEventListener("ended",function(r){$(".success-message").fadeIn()},!1),r.play()})}}).start()}]);